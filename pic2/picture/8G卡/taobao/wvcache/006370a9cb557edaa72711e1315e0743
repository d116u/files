!function(win,undef){function compareVersion(a,b){var c=0,d=0;return a=a.split("."),b=b.split("."),c=parseFloat(1e3*(parseInt(a[0])||0)+parseInt(a[1])+"."+parseInt(a[2]||0)),d=parseFloat(1e3*(parseInt(b[0])||0)+parseInt(b[1])+"."+parseInt(b[2]||0)),c>=d}function callback(a,b){isAndroid&&!compareVersion(osVersion,"2.4.0")?setTimeout(function(){a&&a(b.value||b)},1):a&&a(b.value||b)}var doc=win.document,ua=win.navigator.userAgent,isIOS=/iPhone|iPad|iPod/i.test(ua),isAndroid=/Android/i.test(ua),isWindVane=/WindVane/i.test(ua),osVersion=ua.match(/(?:OS|Android)[\/\s](\d+[._]\d+(?:[._]\d+)?)/i),wvVersion=ua.match(/WindVane[\/\s](\d+[._]\d+[._]\d+)/),hasOwnProperty=Object.prototype.hasOwnProperty,WindVane=win.WindVane||(win.WindVane={}),WindVane_Native=win.WindVane_Native,callbackMap={},inc=1,iframePool=[],iframeLimit=3,LOCAL_PROTOCOL="hybrid",WV_PROTOCOL="wv_hybrid",IFRAME_PREFIX="iframe_",SUCCESS_PREFIX="suc_",FAILURE_PREFIX="err_",PARAM_PREFIX="param_";osVersion=osVersion?(osVersion[1]||"0.0.0").replace("_","."):"0.0.0",wvVersion=wvVersion?(wvVersion[1]||"0.0.0").replace("_","."):"0.0.0";var WV_Core={call:function(a,b,c,d,e,f){var g;g=f>0?setTimeout(function(){WV_Core.onFailure(g,{ret:"TIMEOUT"})},f):WV_Private.getSid(),WV_Private.registerCall(g,d,e),isAndroid?compareVersion(wvVersion,"2.7.0")?WV_Private.callMethodByPrompt(a,b,WV_Private.buildParam(c),g+""):WindVane_Native&&WindVane_Native.callMethod&&WindVane_Native.callMethod(a,b,WV_Private.buildParam(c),g+""):isIOS&&WV_Private.callMethodByIframe(a,b,WV_Private.buildParam(c),g+"")},fireEvent:function(a,b){var c=doc.createEvent("HTMLEvents");c.initEvent(a,!1,!0),c.param=WV_Private.parseParam(b),doc.dispatchEvent(c)},getParam:function(a){return WV_Private.params[PARAM_PREFIX+a]||""},onSuccess:function(a,b){clearTimeout(a);var c=WV_Private.unregisterCall(a).success,d=WV_Private.parseParam(b);callback(c,d),WindVane_Native||WV_Private.onComplete(a)},onFailure:function(a,b){clearTimeout(a);var c=WV_Private.unregisterCall(a).failure,d=WV_Private.parseParam(b);callback(c,d),WindVane_Native||WV_Private.onComplete(a)}},WV_Private={params:{},buildParam:function(a){return a&&"object"==typeof a?JSON.stringify(a):a||""},parseParam:function(str){if(str&&"string"==typeof str)try{obj=JSON.parse(str)}catch(e){obj=eval("("+str+")")}else obj=str||{};return obj},getSid:function(){return Math.floor(Math.random()*(1<<50))+""+inc++},registerCall:function(a,b,c){b&&(callbackMap[SUCCESS_PREFIX+a]=b),c&&(callbackMap[FAILURE_PREFIX+a]=c)},unregisterCall:function(a){var b=SUCCESS_PREFIX+a,c=FAILURE_PREFIX+a,d={success:callbackMap[b],failure:callbackMap[c]};return delete callbackMap[b],delete callbackMap[c],d},useIframe:function(a,b){var c=IFRAME_PREFIX+a,d=iframePool.pop();d||(d=doc.createElement("iframe"),d.setAttribute("frameborder","0"),d.style.cssText="width:0;height:0;border:0;display:none;"),d.setAttribute("id",c),d.setAttribute("src",b),d.parentNode||setTimeout(function(){doc.body.appendChild(d)},5)},retrieveIframe:function(a){var b=IFRAME_PREFIX+a,c=doc.querySelector("#"+b);iframePool.length>=iframeLimit?doc.body.removeChild(c):iframePool.push(c)},callMethodByIframe:function(a,b,c,d){var e=LOCAL_PROTOCOL+"://"+a+":"+d+"/"+b+"?"+c;this.params[PARAM_PREFIX+d]=c,this.useIframe(d,e)},callMethodByPrompt:function(a,b,c,d){var e=LOCAL_PROTOCOL+"://"+a+":"+d+"/"+b+"?"+c,f=WV_PROTOCOL+":";this.params[PARAM_PREFIX+d]=c,window.prompt(e,f)},onComplete:function(a){this.retrieveIframe(a),delete this.params[PARAM_PREFIX+a]}};for(var key in WV_Core)hasOwnProperty.call(WindVane,key)||(WindVane[key]=WV_Core[key])}(window);